Running simulation
You are using the legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This means that tokens that come after special tokens will not be properly handled. We recommend you to read the related pull request available at https://github.com/huggingface/transformers/pull/24565
Done loading model and tokenizer!
Done preprocessing dataset!
/gpfs/bwfor/home/tu/tu_tu/tu_zxojp43/master_thesis/RLHF/reward_model.py:97: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  sampled = grouped.apply(lambda x: x.sample(min(len(x), sample_size), random_state=5))
Reward Logits:  tensor([0.5689])
Reward Logits:  tensor([0.2136])
Reward Logits:  tensor([-0.2769])
Reward Logits:  tensor([2.6751])
Reward Logits:  tensor([-1.3553])
Reward Logits:  tensor([1.9981])
Reward Logits:  tensor([2.5948])
Reward Logits:  tensor([1.2959])
Reward Logits:  tensor([1.7485])
Reward Logits:  tensor([1.9177])
Reward Logits:  tensor([2.9769])
Reward Logits:  tensor([1.8885])
Reward Logits:  tensor([-0.3103])
Reward Logits:  tensor([3.3412])
Reward Logits:  tensor([0.2900])
Reward Logits:  tensor([2.6177])
Reward Logits:  tensor([0.9128])
Reward Logits:  tensor([-1.0099])
Reward Logits:  tensor([2.1976])
Reward Logits:  tensor([2.3840])
Reward Logits:  tensor([1.3518])
Reward Logits:  tensor([2.0033])
Reward Logits:  tensor([0.9252])
Reward Logits:  tensor([1.7123])
Reward Logits:  tensor([1.3439])
Reward Logits:  tensor([-0.7948])
Reward Logits:  tensor([1.9473])
Reward Logits:  tensor([2.4854])
Reward Logits:  tensor([1.5815])
Reward Logits:  tensor([0.7823])
Reward Logits:  tensor([0.0646])
Reward Logits:  tensor([4.0845])
Reward Logits:  tensor([0.2900])
Reward Logits:  tensor([2.6177])
Reward Logits:  tensor([1.6567])
Reward Logits:  tensor([-0.7948])
Reward Logits:  tensor([0.3850])
Reward Logits:  tensor([2.4253])
Reward Logits:  tensor([0.0426])
Reward Logits:  tensor([1.5584])
Reward Logits:  tensor([1.9473])
Reward Logits:  tensor([2.4854])
Reward Logits:  tensor([1.0089])
Reward Logits:  tensor([1.1549])
Reward Logits:  tensor([-0.1645])
Reward Logits:  tensor([1.6500])
Reward Logits:  tensor([1.2212])
Reward Logits:  tensor([1.6655])
Reward Logits:  tensor([1.5810])
Reward Logits:  tensor([2.3641])
Reward Logits:  tensor([2.5948])
Reward Logits:  tensor([1.2959])
Reward Logits:  tensor([-0.2769])
Reward Logits:  tensor([2.6751])
Reward Logits:  tensor([0.9128])
Reward Logits:  tensor([-1.0099])
Reward Logits:  tensor([2.5349])
Reward Logits:  tensor([0.8566])
Reward Logits:  tensor([2.1976])
Reward Logits:  tensor([2.3840])
Reward Logits:  tensor([-0.3103])
Reward Logits:  tensor([3.3412])
Reward Logits:  tensor([0.3681])
Reward Logits:  tensor([2.0712])
Reward Logits:  tensor([1.4828])
Reward Logits:  tensor([0.8390])
Reward Logits:  tensor([1.5071])
Reward Logits:  tensor([2.1986])
Reward Logits:  tensor([0.0415])
Reward Logits:  tensor([2.6233])
Reward Logits:  tensor([0.6108])
Reward Logits:  tensor([2.7460])
Reward Logits:  tensor([-0.2232])
Reward Logits:  tensor([2.0396])
Reward Logits:  tensor([-1.1509])
Reward Logits:  tensor([3.5339])
Reward Logits:  tensor([2.9769])
Reward Logits:  tensor([1.8885])
Reward Logits:  tensor([0.2218])
Reward Logits:  tensor([3.4051])
Reward Logits:  tensor([2.0396])
Reward Logits:  tensor([3.0846])
Reward Logits:  tensor([1.9704])
Reward Logits:  tensor([2.2891])
Reward Logits:  tensor([1.0871])
Reward Logits:  tensor([3.2652])
Reward Logits:  tensor([-0.7239])
Reward Logits:  tensor([1.9980])
Reward Logits:  tensor([0.6770])
Reward Logits:  tensor([3.0852])
Reward Logits:  tensor([-0.1839])
Reward Logits:  tensor([1.0598])
Reward Logits:  tensor([0.0348])
Reward Logits:  tensor([1.5655])
Reward Logits:  tensor([1.0089])
Reward Logits:  tensor([1.1549])
Reward Logits:  tensor([0.9624])
Reward Logits:  tensor([1.4316])
Reward Logits:  tensor([3.6044])
Reward Logits:  tensor([1.6841])
Reward Logits:  tensor([1.0170])
Reward Logits:  tensor([2.6013])
Reward Logits:  tensor([1.2668])
Reward Logits:  tensor([1.9086])
Reward Logits:  tensor([0.8402])
Reward Logits:  tensor([2.2859])
Reward Logits:  tensor([1.2212])
Reward Logits:  tensor([1.6655])
Reward Logits:  tensor([2.8722])
Reward Logits:  tensor([1.4873])
Reward Logits:  tensor([1.0871])
Reward Logits:  tensor([3.2652])
Reward Logits:  tensor([1.0170])
Reward Logits:  tensor([2.6013])
Reward Logits:  tensor([1.9081])
Reward Logits:  tensor([2.1184])
Reward Logits:  tensor([3.4450])
Reward Logits:  tensor([3.4581])
Reward Logits:  tensor([2.5349])
Reward Logits:  tensor([0.8566])
Reward Logits:  tensor([1.5747])
Reward Logits:  tensor([1.2371])
Reward Logits:  tensor([0.9128])
Reward Logits:  tensor([-1.0099])
Reward Logits:  tensor([2.0396])
Reward Logits:  tensor([3.0846])
Reward Logits:  tensor([0.9258])
Reward Logits:  tensor([2.1184])
Reward Logits:  tensor([1.5810])
Reward Logits:  tensor([2.3641])
Reward Logits:  tensor([1.0221])
Reward Logits:  tensor([4.8454])
Reward Logits:  tensor([1.5747])
Reward Logits:  tensor([1.2371])
Reward Logits:  tensor([1.2668])
Reward Logits:  tensor([1.0787])
Reward Logits:  tensor([0.3681])
Reward Logits:  tensor([2.0712])
Reward Logits:  tensor([2.2073])
Reward Logits:  tensor([1.8151])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.1711])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.3405])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.9768])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.3574])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.1622])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.5945])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([7.3052])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.4146])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([3.6561])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([5.9364])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.4684])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([0.6484])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([0.6312])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.1607])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.3738])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.6930])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([7.2449])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.7060])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([3.9937])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.6988])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.2079])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.9333])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([5.1295])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.3454])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([3.6686])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.4475])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([-0.1804])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([0.8724])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([6.7197])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([3.4844])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.6713])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([5.5897])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([3.9704])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([6.6785])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.2111])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.3897])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.9333])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([6.7658])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([6.0950])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([5.5781])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([0.3339])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([6.3702])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([3.8828])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.2124])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.1607])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([0.6961])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.9333])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.2386])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.6886])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([0.8188])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.4182])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([6.2023])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.4458])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([3.6863])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.9693])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.2680])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.1492])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([3.5326])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.8948])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([1.7440])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([0.4052])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.5977])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([5.1352])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.0104])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([5.4283])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([2.4902])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([0.1718])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([8.6887])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([6.2898])
Reward Logits:  tensor([1.3401])
Reward Logits:  tensor([4.0691])
Reward Logits:  tensor([0.5281])
Reward Logits:  tensor([5.0164])
Reward Logits:  tensor([2.0655])
Reward Logits:  tensor([2.0096])
Reward Logits:  tensor([2.5099])
Reward Logits:  tensor([4.2143])
Reward Logits:  tensor([0.6978])
Reward Logits:  tensor([2.4730])
Reward Logits:  tensor([0.7033])
Reward Logits:  tensor([0.2542])
Reward Logits:  tensor([0.4323])
Reward Logits:  tensor([3.4581])
Reward Logits:  tensor([2.2130])
Reward Logits:  tensor([2.5983])
Reward Logits:  tensor([1.2660])
Reward Logits:  tensor([2.4614])
Reward Logits:  tensor([1.7065])
Reward Logits:  tensor([5.5200])
Reward Logits:  tensor([0.6168])
Reward Logits:  tensor([1.9871])
Reward Logits:  tensor([0.4224])
Reward Logits:  tensor([2.0332])
Reward Logits:  tensor([-0.2831])
Reward Logits:  tensor([1.6119])
Reward Logits:  tensor([0.7443])
Reward Logits:  tensor([1.8155])
Reward Logits:  tensor([3.5586])
Reward Logits:  tensor([3.1661])
Reward Logits:  tensor([-0.6093])
Reward Logits:  tensor([1.2886])
Reward Logits:  tensor([0.8958])
Reward Logits:  tensor([2.7664])
Reward Logits:  tensor([-0.2495])
Reward Logits:  tensor([2.9415])
Reward Logits:  tensor([1.1481])
Reward Logits:  tensor([2.3732])
Reward Logits:  tensor([-0.4317])
Reward Logits:  tensor([3.4051])
Reward Logits:  tensor([-0.0392])
Reward Logits:  tensor([2.1527])
Reward Logits:  tensor([1.3584])
Reward Logits:  tensor([4.2015])
Reward Logits:  tensor([0.3580])
Reward Logits:  tensor([4.5703])
Reward Logits:  tensor([1.0124])
Reward Logits:  tensor([4.2584])
Reward Logits:  tensor([0.9505])
Reward Logits:  tensor([2.0517])
Reward Logits:  tensor([0.0915])
Reward Logits:  tensor([2.5520])
Reward Logits:  tensor([2.4408])
Reward Logits:  tensor([2.4408])
Reward Logits:  tensor([-0.9038])
Reward Logits:  tensor([4.3753])
Reward Logits:  tensor([2.2474])
Reward Logits:  tensor([2.0663])
Reward Logits:  tensor([1.4079])
Reward Logits:  tensor([2.8111])
Reward Logits:  tensor([1.4258])
Reward Logits:  tensor([3.4250])
Reward Logits:  tensor([0.7917])
Reward Logits:  tensor([7.4851])
Reward Logits:  tensor([0.4320])
Reward Logits:  tensor([4.3370])
Reward Logits:  tensor([0.7850])
Reward Logits:  tensor([5.2760])
Reward Logits:  tensor([0.0547])
Reward Logits:  tensor([6.6801])
Reward Logits:  tensor([0.6807])
Reward Logits:  tensor([0.2686])
Reward Logits:  tensor([1.3497])
Reward Logits:  tensor([1.3497])
Reward Logits:  tensor([-0.6850])
slurmstepd: error: *** JOB 3910543 ON o07c05 CANCELLED AT 2024-06-19T13:07:50 DUE TO TIME LIMIT ***
