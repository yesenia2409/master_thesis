Running simulation
learning rate: 0.01
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:10<00:20, 10.26s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:19<00:09,  9.89s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:25<00:00,  7.99s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:25<00:00,  8.54s/it]
/home/tu/tu_tu/tu_zxojp43/.local/lib/python3.9/site-packages/peft/utils/other.py:102: FutureWarning: prepare_model_for_int8_training is deprecated and will be removed in a future version. Use prepare_model_for_kbit_training instead.
  warnings.warn(
Map:   0%|          | 0/100 [00:00<?, ? examples/s]Map: 100%|██████████| 100/100 [00:00<00:00, 459.51 examples/s]Map: 100%|██████████| 100/100 [00:00<00:00, 457.07 examples/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]Map: 100%|██████████| 100/100 [00:00<00:00, 2098.61 examples/s]
  0%|          | 0/9 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/home/tu/tu_tu/tu_zxojp43/.local/lib/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 11%|█         | 1/9 [00:24<03:17, 24.64s/it] 22%|██▏       | 2/9 [00:46<02:41, 23.07s/it] 33%|███▎      | 3/9 [01:07<02:11, 21.85s/it]                                             {'loss': 2.725, 'learning_rate': 0.0003, 'epoch': 0.96}
 33%|███▎      | 3/9 [01:10<02:11, 21.85s/it]
  0%|          | 0/50 [00:00<?, ?it/s][A
  4%|▍         | 2/50 [00:00<00:11,  4.23it/s][A
  6%|▌         | 3/50 [00:00<00:14,  3.31it/s][A
  8%|▊         | 4/50 [00:01<00:17,  2.69it/s][A
 10%|█         | 5/50 [00:01<00:17,  2.60it/s][A
 12%|█▏        | 6/50 [00:02<00:18,  2.41it/s][A
 14%|█▍        | 7/50 [00:02<00:19,  2.19it/s][A
 16%|█▌        | 8/50 [00:03<00:19,  2.12it/s][A
 18%|█▊        | 9/50 [00:03<00:19,  2.14it/s][A
 20%|██        | 10/50 [00:04<00:20,  2.00it/s][A
 22%|██▏       | 11/50 [00:04<00:20,  1.87it/s][A
 24%|██▍       | 12/50 [00:05<00:18,  2.03it/s][A
 26%|██▌       | 13/50 [00:05<00:16,  2.22it/s][A
 28%|██▊       | 14/50 [00:05<00:14,  2.46it/s][A
 30%|███       | 15/50 [00:06<00:13,  2.68it/s][A
 32%|███▏      | 16/50 [00:06<00:12,  2.63it/s][A
 34%|███▍      | 17/50 [00:07<00:13,  2.50it/s][A
 36%|███▌      | 18/50 [00:07<00:13,  2.43it/s][A
 38%|███▊      | 19/50 [00:07<00:12,  2.56it/s][A
 40%|████      | 20/50 [00:08<00:12,  2.49it/s][A
 42%|████▏     | 21/50 [00:08<00:10,  2.69it/s][A
 44%|████▍     | 22/50 [00:09<00:10,  2.61it/s][A
 46%|████▌     | 23/50 [00:09<00:11,  2.40it/s][A
 48%|████▊     | 24/50 [00:10<00:12,  2.14it/s][A
 50%|█████     | 25/50 [00:10<00:12,  1.95it/s][A
 52%|█████▏    | 26/50 [00:11<00:12,  1.93it/s][A
 54%|█████▍    | 27/50 [00:11<00:11,  2.08it/s][A
 56%|█████▌    | 28/50 [00:11<00:09,  2.37it/s][A
 58%|█████▊    | 29/50 [00:12<00:09,  2.28it/s][A
 60%|██████    | 30/50 [00:12<00:08,  2.37it/s][A
 62%|██████▏   | 31/50 [00:13<00:08,  2.26it/s][A
 64%|██████▍   | 32/50 [00:13<00:08,  2.04it/s][A
 66%|██████▌   | 33/50 [00:14<00:07,  2.16it/s][A
 68%|██████▊   | 34/50 [00:14<00:07,  2.05it/s][A
 70%|███████   | 35/50 [00:15<00:07,  1.89it/s][A
 72%|███████▏  | 36/50 [00:16<00:07,  1.80it/s][A
 74%|███████▍  | 37/50 [00:16<00:07,  1.74it/s][A
 76%|███████▌  | 38/50 [00:17<00:06,  1.72it/s][A
 78%|███████▊  | 39/50 [00:17<00:06,  1.69it/s][A
 80%|████████  | 40/50 [00:18<00:05,  1.78it/s][A
 82%|████████▏ | 41/50 [00:18<00:04,  1.98it/s][A
 84%|████████▍ | 42/50 [00:19<00:03,  2.18it/s][A
 86%|████████▌ | 43/50 [00:19<00:02,  2.46it/s][A
 88%|████████▊ | 44/50 [00:19<00:02,  2.25it/s][A
 90%|█████████ | 45/50 [00:20<00:02,  2.27it/s][A
 92%|█████████▏| 46/50 [00:20<00:01,  2.24it/s][A
 94%|█████████▍| 47/50 [00:21<00:01,  2.05it/s][A
 96%|█████████▌| 48/50 [00:21<00:01,  1.99it/s][A
 98%|█████████▊| 49/50 [00:22<00:00,  2.23it/s][A
100%|██████████| 50/50 [00:22<00:00,  2.45it/s][A                                             
                                               [A{'eval_loss': 2.4519217014312744, 'eval_runtime': 23.2507, 'eval_samples_per_second': 4.301, 'eval_steps_per_second': 2.15, 'epoch': 0.96}
 33%|███▎      | 3/9 [01:33<02:11, 21.85s/it]
100%|██████████| 50/50 [00:22<00:00,  2.45it/s][A
                                               [A/home/tu/tu_tu/tu_zxojp43/.local/lib/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 44%|████▍     | 4/9 [01:54<02:40, 32.15s/it] 56%|█████▌    | 5/9 [02:16<01:53, 28.25s/it] 67%|██████▋   | 6/9 [02:37<01:17, 25.70s/it]                                             {'loss': 2.3438, 'learning_rate': 0.0006, 'epoch': 1.92}
 67%|██████▋   | 6/9 [02:42<01:17, 25.70s/it]
  0%|          | 0/50 [00:00<?, ?it/s][A
  4%|▍         | 2/50 [00:00<00:13,  3.48it/s][A
  6%|▌         | 3/50 [00:00<00:15,  2.99it/s][A
  8%|▊         | 4/50 [00:01<00:18,  2.54it/s][A
 10%|█         | 5/50 [00:01<00:18,  2.50it/s][A
 12%|█▏        | 6/50 [00:02<00:18,  2.35it/s][A
 14%|█▍        | 7/50 [00:02<00:20,  2.15it/s][A
 16%|█▌        | 8/50 [00:03<00:20,  2.09it/s][A
 18%|█▊        | 9/50 [00:03<00:19,  2.11it/s][A
 20%|██        | 10/50 [00:04<00:20,  1.98it/s][A
 22%|██▏       | 11/50 [00:05<00:20,  1.86it/s][A
 24%|██▍       | 12/50 [00:05<00:18,  2.01it/s][A
 26%|██▌       | 13/50 [00:05<00:16,  2.21it/s][A
 28%|██▊       | 14/50 [00:06<00:14,  2.44it/s][A
 30%|███       | 15/50 [00:06<00:12,  2.72it/s][A
 32%|███▏      | 16/50 [00:06<00:12,  2.65it/s][A
 34%|███▍      | 17/50 [00:07<00:13,  2.51it/s][A
 36%|███▌      | 18/50 [00:07<00:13,  2.44it/s][A
 38%|███▊      | 19/50 [00:08<00:12,  2.56it/s][A
 40%|████      | 20/50 [00:08<00:12,  2.49it/s][A
 42%|████▏     | 21/50 [00:08<00:10,  2.68it/s][A
 44%|████▍     | 22/50 [00:09<00:10,  2.60it/s][A
 46%|████▌     | 23/50 [00:09<00:11,  2.40it/s][A
 48%|████▊     | 24/50 [00:10<00:12,  2.13it/s][A
 50%|█████     | 25/50 [00:10<00:12,  1.94it/s][A
 52%|█████▏    | 26/50 [00:11<00:12,  1.92it/s][A
 54%|█████▍    | 27/50 [00:11<00:11,  2.07it/s][A
 56%|█████▌    | 28/50 [00:12<00:09,  2.36it/s][A
 58%|█████▊    | 29/50 [00:12<00:09,  2.27it/s][A
 60%|██████    | 30/50 [00:12<00:08,  2.36it/s][A
 62%|██████▏   | 31/50 [00:13<00:08,  2.25it/s][A
 64%|██████▍   | 32/50 [00:14<00:08,  2.03it/s][A
 66%|██████▌   | 33/50 [00:14<00:07,  2.15it/s][A
 68%|██████▊   | 34/50 [00:15<00:07,  2.04it/s][A
 70%|███████   | 35/50 [00:15<00:07,  1.88it/s][A
 72%|███████▏  | 36/50 [00:16<00:07,  1.79it/s][A
 74%|███████▍  | 37/50 [00:16<00:07,  1.73it/s][A
 76%|███████▌  | 38/50 [00:17<00:07,  1.71it/s][A
 78%|███████▊  | 39/50 [00:18<00:06,  1.69it/s][A
 80%|████████  | 40/50 [00:18<00:05,  1.78it/s][A
 82%|████████▏ | 41/50 [00:18<00:04,  1.97it/s][A
 84%|████████▍ | 42/50 [00:19<00:03,  2.17it/s][A
 86%|████████▌ | 43/50 [00:19<00:02,  2.45it/s][A
 88%|████████▊ | 44/50 [00:20<00:02,  2.24it/s][A
 90%|█████████ | 45/50 [00:20<00:02,  2.26it/s][A
 92%|█████████▏| 46/50 [00:21<00:01,  2.23it/s][A
 94%|█████████▍| 47/50 [00:21<00:01,  2.04it/s][A
 96%|█████████▌| 48/50 [00:22<00:01,  1.98it/s][A
 98%|█████████▊| 49/50 [00:22<00:00,  2.22it/s][A
100%|██████████| 50/50 [00:22<00:00,  2.44it/s][A                                             
                                               [A{'eval_loss': 1.946332573890686, 'eval_runtime': 23.2296, 'eval_samples_per_second': 4.305, 'eval_steps_per_second': 2.152, 'epoch': 1.92}
 67%|██████▋   | 6/9 [03:05<01:17, 25.70s/it]
100%|██████████| 50/50 [00:22<00:00,  2.44it/s][A
                                               [A/home/tu/tu_tu/tu_zxojp43/.local/lib/python3.9/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 78%|███████▊  | 7/9 [03:23<01:05, 32.55s/it] 89%|████████▉ | 8/9 [03:45<00:29, 29.05s/it]100%|██████████| 9/9 [04:07<00:00, 26.79s/it]                                             {'loss': 1.5925, 'learning_rate': 0.0009, 'epoch': 2.88}
100%|██████████| 9/9 [04:07<00:00, 26.79s/it]
  0%|          | 0/50 [00:00<?, ?it/s][A
  4%|▍         | 2/50 [00:00<00:13,  3.47it/s][A
  6%|▌         | 3/50 [00:00<00:15,  2.98it/s][A
  8%|▊         | 4/50 [00:01<00:18,  2.54it/s][A
 10%|█         | 5/50 [00:01<00:18,  2.50it/s][A
 12%|█▏        | 6/50 [00:02<00:18,  2.34it/s][A
 14%|█▍        | 7/50 [00:02<00:20,  2.15it/s][A
 16%|█▌        | 8/50 [00:03<00:20,  2.09it/s][A
 18%|█▊        | 9/50 [00:03<00:19,  2.11it/s][A
 20%|██        | 10/50 [00:04<00:20,  1.98it/s][A
 22%|██▏       | 11/50 [00:05<00:21,  1.86it/s][A
 24%|██▍       | 12/50 [00:05<00:18,  2.01it/s][A
 26%|██▌       | 13/50 [00:05<00:16,  2.21it/s][A
 28%|██▊       | 14/50 [00:06<00:14,  2.44it/s][A
 30%|███       | 15/50 [00:06<00:12,  2.72it/s][A
 32%|███▏      | 16/50 [00:06<00:12,  2.65it/s][A
 34%|███▍      | 17/50 [00:07<00:13,  2.51it/s][A
 36%|███▌      | 18/50 [00:07<00:13,  2.43it/s][A
 38%|███▊      | 19/50 [00:08<00:12,  2.55it/s][A
 40%|████      | 20/50 [00:08<00:12,  2.48it/s][A
 42%|████▏     | 21/50 [00:08<00:10,  2.68it/s][A
 44%|████▍     | 22/50 [00:09<00:10,  2.60it/s][A
 46%|████▌     | 23/50 [00:09<00:11,  2.39it/s][A
 48%|████▊     | 24/50 [00:10<00:12,  2.12it/s][A
 50%|█████     | 25/50 [00:10<00:12,  1.94it/s][A
 52%|█████▏    | 26/50 [00:11<00:12,  1.92it/s][A
 54%|█████▍    | 27/50 [00:11<00:11,  2.06it/s][A
 56%|█████▌    | 28/50 [00:12<00:09,  2.35it/s][A
 58%|█████▊    | 29/50 [00:12<00:09,  2.26it/s][A
 60%|██████    | 30/50 [00:12<00:08,  2.35it/s][A
 62%|██████▏   | 31/50 [00:13<00:08,  2.24it/s][A
 64%|██████▍   | 32/50 [00:14<00:08,  2.03it/s][A
 66%|██████▌   | 33/50 [00:14<00:07,  2.15it/s][A
 68%|██████▊   | 34/50 [00:15<00:07,  2.03it/s][A
 70%|███████   | 35/50 [00:15<00:07,  1.88it/s][A
 72%|███████▏  | 36/50 [00:16<00:07,  1.79it/s][A
 74%|███████▍  | 37/50 [00:16<00:07,  1.73it/s][A
 76%|███████▌  | 38/50 [00:17<00:07,  1.71it/s][A
 78%|███████▊  | 39/50 [00:18<00:06,  1.68it/s][A
 80%|████████  | 40/50 [00:18<00:05,  1.77it/s][A
 82%|████████▏ | 41/50 [00:19<00:04,  1.97it/s][A
 84%|████████▍ | 42/50 [00:19<00:03,  2.16it/s][A
 86%|████████▌ | 43/50 [00:19<00:02,  2.44it/s][A
 88%|████████▊ | 44/50 [00:20<00:02,  2.23it/s][A
 90%|█████████ | 45/50 [00:20<00:02,  2.26it/s][A
 92%|█████████▏| 46/50 [00:21<00:01,  2.22it/s][A
 94%|█████████▍| 47/50 [00:21<00:01,  2.03it/s][A
 96%|█████████▌| 48/50 [00:22<00:01,  1.98it/s][A
 98%|█████████▊| 49/50 [00:22<00:00,  2.22it/s][A
100%|██████████| 50/50 [00:22<00:00,  2.43it/s][A                                             
                                               [A{'eval_loss': 1.530267357826233, 'eval_runtime': 23.2747, 'eval_samples_per_second': 4.297, 'eval_steps_per_second': 2.148, 'epoch': 2.88}
100%|██████████| 9/9 [04:30<00:00, 26.79s/it]
100%|██████████| 50/50 [00:22<00:00,  2.43it/s][A
                                               [A                                             {'train_runtime': 270.6119, 'train_samples_per_second': 1.109, 'train_steps_per_second': 0.033, 'train_loss': 2.2204372617933483, 'epoch': 2.88}
100%|██████████| 9/9 [04:30<00:00, 26.79s/it]100%|██████████| 9/9 [04:30<00:00, 30.07s/it]
trainer.state.log_history:  [{'loss': 2.725, 'learning_rate': 0.0003, 'epoch': 0.96, 'step': 3}, {'eval_loss': 2.4519217014312744, 'eval_runtime': 23.2507, 'eval_samples_per_second': 4.301, 'eval_steps_per_second': 2.15, 'epoch': 0.96, 'step': 3}, {'loss': 2.3438, 'learning_rate': 0.0006, 'epoch': 1.92, 'step': 6}, {'eval_loss': 1.946332573890686, 'eval_runtime': 23.2296, 'eval_samples_per_second': 4.305, 'eval_steps_per_second': 2.152, 'epoch': 1.92, 'step': 6}, {'loss': 1.5925, 'learning_rate': 0.0009, 'epoch': 2.88, 'step': 9}, {'eval_loss': 1.530267357826233, 'eval_runtime': 23.2747, 'eval_samples_per_second': 4.297, 'eval_steps_per_second': 2.148, 'epoch': 2.88, 'step': 9}, {'train_runtime': 270.6119, 'train_samples_per_second': 1.109, 'train_steps_per_second': 0.033, 'total_flos': 3165777990144000.0, 'train_loss': 2.2204372617933483, 'epoch': 2.88, 'step': 9}]
train_results:  TrainOutput(global_step=9, training_loss=2.2204372617933483, metrics={'train_runtime': 270.6119, 'train_samples_per_second': 1.109, 'train_steps_per_second': 0.033, 'train_loss': 2.2204372617933483, 'epoch': 2.88})
